
def requireSession(*gin.Context c) (
    string sessionId = c.Cookie("session_id").toArray()[1].toStr()
    if sessionId == "" (
        c.Redirect(302, "/auth")
        c.Abort()
        return
    )
    if !sessions.contains(sessionId) (
        c.Redirect(302, "/auth")
        c.Abort()
        return
    )
    c.Set("username", sessions[sessionId])
    c.Next()
)